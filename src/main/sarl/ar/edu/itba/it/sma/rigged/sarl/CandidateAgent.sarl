package ar.edu.itba.^it.sma.rigged.sarl

import ar.edu.itba.^it.sma.rigged.sarl.support.Proposal
import java.util.UUID
import java.util.List
import java.util.LinkedList
import io.sarl.core.Initialize
import io.sarl.core.Logging
import io.sarl.core.DefaultContextInteractions
import io.sarl.util.Scopes
import io.sarl.lang.core.Address

agent CandidateAgent {
	uses DefaultContextInteractions, Logging
	val history : List<Proposal> = new LinkedList<Proposal>
	var electoralCommitteeUUID : UUID
	var name : String
	
	on Initialize [ 
		!occurrence.parameters.empty && 
		occurrence.parameters.length == 3
	] {
		name = occurrence.parameters.get(0) as String
		electoralCommitteeUUID = occurrence.parameters.get(1) as UUID
		history.addAll(occurrence.parameters.get(2) as List<Proposal>)
		emit(new SuscribeCandidateEvent(this), 
			Scopes.addresses(new Address(defaultSpace.getID, electoralCommitteeUUID))
		)
		println("Hi! I'm " + name + "!")
	}
	
}